#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å DeepSeek API
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞ –∏ —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏
"""

import os
from dotenv import load_dotenv
import openai

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()
DEEPSEEK_API_KEY = os.getenv('DEEPSEEK_API_KEY')

print("=" * 60)
print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï DEEPSEEK –ò–ù–¢–ï–ì–†–ê–¶–ò–ò")
print("=" * 60)

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞
print("\n1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞...")
if DEEPSEEK_API_KEY:
    print(f"   ‚úÖ –ö–ª—é—á –Ω–∞–π–¥–µ–Ω: {DEEPSEEK_API_KEY[:10]}...")
else:
    print("   ‚ùå –û—à–∏–±–∫–∞: DEEPSEEK_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ .env")
    exit(1)

# 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
print("\n2Ô∏è‚É£ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OpenAI –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è DeepSeek...")
try:
    client = openai.OpenAI(
        api_key=DEEPSEEK_API_KEY,
        base_url="https://api.deepseek.com/v1"
    )
    print("   ‚úÖ –ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
except Exception as e:
    print(f"   ‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")
    exit(1)

# 3. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º (—á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π)
print("\n3Ô∏è‚É£ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (English)...")
try:
    response = client.chat.completions.create(
        model="deepseek-chat",
        messages=[
            {"role": "system", "content": "You are a helpful assistant."},
            {"role": "user", "content": "Say hello in Russian"}
        ],
        max_tokens=100,
        temperature=0.7
    )
    answer = response.choices[0].message.content.strip()
    print(f"   ‚úÖ –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω: {answer[:50]}...")
except Exception as e:
    error_msg = str(e)
    print(f"   ‚ùå –û—à–∏–±–∫–∞: {error_msg}")
    
    if "401" in error_msg:
        print("\n   üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –≤ .env")
    elif "402" in error_msg or "insufficient" in error_msg:
        print("\n   üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å DeepSeek")
    elif "429" in error_msg:
        print("\n   üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–¥–æ–∂–¥–∏—Ç–µ")

# 4. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
print("\n4Ô∏è‚É£ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –±–æ—Ç–∞:")
print("""
   üìã –¢–ï–ö–£–©–ò–ï –ù–ê–°–¢–†–û–ô–ö–ò –í bot.py:
   
   model = "deepseek-chat"           # –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
   max_tokens = 1024                 # –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –æ—Ç–≤–µ—Ç
   temperature = 0.8                 # 0.8 - –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä
   top_p = 0.95                      # –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
   frequency_penalty = 0.5           #ÈÅøÂÖç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
   
   üí° –û–ë–™–Ø–°–ù–ï–ù–ò–ï –ü–ê–†–ê–ú–ï–¢–†–û–í:
   
   ‚Ä¢ temperature (0.0 - 2.0):
     - 0.0 = –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, —Å–∫—É—á–Ω—ã–π
     - 0.7 = —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
     - 0.8 = –±–æ–ª–µ–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π, –∂–∏–≤–æ–π
     - 1.0+ = –æ—á–µ–Ω—å –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π, –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ø–æ–Ω—Ç–∞–Ω–Ω—ã–º
     
   ‚Ä¢ max_tokens:
     - 512 = –∫—Ä–∞—Ç–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
     - 1024 = –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–¢–ï–ö–£–©–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê)
     - 2048+ = –¥–ª–∏–Ω–Ω—ã–µ, –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
     
   ‚Ä¢ top_p (nucleus sampling):
     - 0.5 = –±–æ–ª–µ–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
     - 0.95 = –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (—Ç–µ–∫—É—â–∞—è)
     
   ‚Ä¢ frequency_penalty:
     - 0.0 = –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ñ—Ä–∞–∑—ã
     - 0.5 = –Ω–æ—Ä–º–∞–ª—å–Ω–æ (—Ç–µ–∫—É—â–∞—è)
     - 1.0+ = –∏–∑–±–µ–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π
""")

# 5. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
print("\n5Ô∏è‚É£ –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å:")
print("   ‚úÖ DeepSeek –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!")
print("   ‚úÖ API –∫–ª—é—á –≤–∞–ª–∏–¥–µ–Ω")
print("   ‚úÖ –ú–æ–¥–µ–ª—å 'deepseek-chat' –¥–æ—Å—Ç—É–ø–Ω–∞")
print("\n" + "=" * 60)
print("‚úÖ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´!")
print("=" * 60)
