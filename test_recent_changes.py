#!/usr/bin/env python3
"""
–ü–û–õ–ù–´–ô –¢–ï–°–¢ –í–°–ï–• –ò–ó–ú–ï–ù–ï–ù–ò–ô –ü–û–°–õ–ï–î–ù–ò–• 3 –ß–ê–°–û–í
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ /start
2. –ù–æ–≤—ã–π –ø–æ–∏—Å–∫ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
3. –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (—Å–ª–æ–Ω–æ–≤, –∞–≤–∞—Ç–∞—Ä–∞ –∏ —Ç.–¥.)
4. –ì–∏–±—Ä–∏–¥–Ω–æ–µ –º–µ–Ω—é –∫–∞—Ç–µ–≥–æ—Ä–∏–π
5. –£–¥–∞–ª–µ–Ω–∏–µ —Å–∫–æ–±–æ–∫ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Ç—É—Ä–æ–≤
6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ —Ç—É—Ä—ã
7. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É/–±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏
"""

import pandas as pd
import sys
import json

# –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
df = pd.read_csv('Price22.12.2025.csv', delimiter=';', encoding='utf-8-sig')
TOURS = []
for idx, row in df.iterrows():
    TOURS.append(dict(row))

print("=" * 80)
print("üß™ –ü–û–õ–ù–´–ô –¢–ï–°–¢ –ò–ó–ú–ï–ù–ï–ù–ò–ô –ü–û–°–õ–ï–î–ù–ò–• 3 –ß–ê–°–û–í")
print("=" * 80)

# ============================================================================
# –¢–ï–°–¢ 1: –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ò –ö–ê–¢–ï–ì–û–†–ò–ò
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏")
print("-" * 80)

categories = sorted(df['–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏'].unique().tolist())
print(f"üìÇ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(TOURS)} —Ç—É—Ä–æ–≤")
print(f"üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: {len(categories)}")
for i, cat in enumerate(categories, 1):
    count = len([t for t in TOURS if t.get('–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏') == cat])
    print(f"   {i}. {cat}: {count} —Ç—É—Ä–æ–≤")

assert len(TOURS) == 99, f"‚ùå –û–®–ò–ë–ö–ê: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 99 —Ç—É—Ä–æ–≤, –Ω–∞–π–¥–µ–Ω–æ {len(TOURS)}"
assert len(categories) == 8, f"‚ùå –û–®–ò–ë–ö–ê: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –Ω–∞–π–¥–µ–Ω–æ {len(categories)}"
print("‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ")

# ============================================================================
# –¢–ï–°–¢ 2: –ü–û–ò–°–ö –ü–û –ö–õ–Æ–ß–ï–í–´–ú –°–õ–û–í–ê–ú
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 2: –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥)")
print("-" * 80)

def search_tours_by_keywords(query):
    query_lower = query.lower().strip()
    if not query_lower:
        return []
    results = []
    for tour in TOURS:
        relevance = 0
        tour_name = tour.get('–ù–∞–∑–≤–∞–Ω–∏–µ', '').lower()
        if query_lower in tour_name:
            relevance += 100
        keywords = tour.get('–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞', '')
        if keywords:
            keywords_lower = str(keywords).lower()
            if query_lower in keywords_lower:
                relevance += 50
        description = tour.get('–û–ø–∏—Å–∞–Ω–∏–µ (–í–∏—Ç—Ä–∏–Ω–∞)', '')
        if description:
            description_lower = str(description).lower()
            if query_lower in description_lower:
                relevance += 30
        review = tour.get('–ß–µ—Å—Ç–Ω—ã–π –æ–±–∑–æ—Ä', '')
        if review:
            review_lower = str(review).lower()
            if query_lower in review_lower:
                relevance += 20
        if relevance > 0:
            category = tour.get('–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è')
            results.append((tour, category, relevance))
    results.sort(key=lambda x: x[2], reverse=True)
    return results

test_queries = ['—Å–ª–æ–Ω–æ–≤', '–∞–≤–∞—Ç–∞—Ä', '—Ä—ã–±–∞', '–∫–∞—Ç–µ—Ä', '–¥–µ–ª—å—Ñ–∏–Ω–æ–≤', '—Ö—Ä–∞–º']
for query in test_queries:
    results = search_tours_by_keywords(query)
    assert len(results) > 0, f"‚ùå –û–®–ò–ë–ö–ê: –ø–æ –∑–∞–ø—Ä–æ—Å—É '{query}' –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!"
    categories_found = {}
    for tour, cat, rel in results:
        if cat not in categories_found:
            categories_found[cat] = 0
        categories_found[cat] += 1
    print(f"‚úÖ '{query}' ‚Üí {len(results)} —Ç—É—Ä–æ–≤: {', '.join(categories_found.keys())}")

print("‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!")

# ============================================================================
# –¢–ï–°–¢ 3: –£–î–ê–õ–ï–ù–ò–ï –°–ö–û–ë–û–ö –í –ù–ê–ó–í–ê–ù–ò–Ø–•
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 3: –£–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —Å–∫–æ–±–æ–∫ () –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π")
print("-" * 80)

problematic_tours = []
for tour in TOURS:
    name = tour.get('–ù–∞–∑–≤–∞–Ω–∏–µ', '')
    if '()' in name:
        problematic_tours.append(name)

if problematic_tours:
    print(f"‚ö†Ô∏è  –ù–ê–ô–î–ï–ù–û {len(problematic_tours)} —Ç—É—Ä–æ–≤ —Å –ø—É—Å—Ç—ã–º–∏ —Å–∫–æ–±–∫–∞–º–∏ ():")
    for name in problematic_tours[:5]:
        print(f"   - {name}")
    print("   –§—É–Ω–∫—Ü–∏—è make_tours_keyboard() —É–¥–∞–ª–∏—Ç –∏—Ö –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏")
    print("‚úÖ –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç")
else:
    print("‚úÖ –ü—É—Å—Ç—ã—Ö —Å–∫–æ–±–æ–∫ –≤ CSV –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

# ============================================================================
# –¢–ï–°–¢ 4: –ì–ò–ë–†–ò–î–ù–û–ï –ú–ï–ù–Æ –ö–ê–¢–ï–ì–û–†–ò–ô
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 4: –ì–∏–±—Ä–∏–¥–Ω–æ–µ –º–µ–Ω—é –∫–∞—Ç–µ–≥–æ—Ä–∏–π (3 –•–ò–¢ + –æ—Å—Ç–∞–ª—å–Ω—ã–µ)")
print("-" * 80)

hit_categories = [
    "–ú–æ—Ä–µ (–û—Å—Ç—Ä–æ–≤–∞)",
    "–°—É—à–∞ (—Å–µ–º–µ–π–Ω—ã–µ)",
    "–í–µ—á–µ—Ä–Ω–∏–µ –®–æ—É"
]

print("üèÜ –•–ò–¢ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫—Ä—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏):")
for cat in hit_categories:
    assert cat in categories, f"‚ùå –û–®–ò–ë–ö–ê: {cat} –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π!"
    print(f"   ‚úÖ {cat}")

remaining = [c for c in categories if c not in hit_categories]
print(f"\nüìã –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ 2 –≤ —Ä—è–¥ ({len(remaining)} –∫–∞—Ç–µ–≥–æ—Ä–∏–π):")
for i in range(0, len(remaining), 2):
    row = remaining[i:i+2]
    print(f"   ‚úÖ {' | '.join(row)}")

print(f"\n‚úÖ –ì–∏–±—Ä–∏–¥–Ω–æ–µ –º–µ–Ω—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:")
print(f"   ‚Ä¢ –•–ò–¢ –∫–Ω–æ–ø–æ–∫: 3")
print(f"   ‚Ä¢ –°—Ç—Ä–æ–∫ –º–µ–Ω—é: {(len(remaining) + 1) // 2}")
print(f"   ‚Ä¢ –ö–Ω–æ–ø–∫–∞ '–ù–æ–≤—ã–π –ø–æ–∏—Å–∫': –¥–∞")
print(f"   ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞: ~40%")

# ============================================================================
# –¢–ï–°–¢ 5: –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ü–û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 5: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É/–±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏")
print("-" * 80)

def filter_tours_by_safety(tours, user_data):
    filtered_tours = []
    is_pregnant = user_data.get('pregnant', False)
    children_ages = user_data.get('children', [])
    health_issues = user_data.get('health_issues', [])
    
    for tour in tours:
        is_safe = True
        tags = tour.get("–¢–µ–≥–∏ (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)", "").lower()
        
        # 1. –ë–ï–†–ï–ú–ï–ù–ù–´–ï - –≤—Å–µ –º–æ—Ä–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
        if is_pregnant:
            if "–º–æ—Ä–µ" in tour.get('–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏', '').lower():
                is_safe = False
            elif "#–Ω–µ–ª—å–∑—è_–±–µ—Ä–µ–º–µ–Ω–Ω—ã–º" in tags:
                is_safe = False
        
        # 2. –î–ï–¢–ò –î–û 1 –ì–û–î–ê - –≤—Å–µ –º–æ—Ä–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ
        if children_ages:
            for age_months in children_ages:
                if age_months < 12:  # –î–æ 1 –≥–æ–¥–∞
                    if "–º–æ—Ä–µ" in tour.get('–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏', '').lower():
                        is_safe = False
                        break
        
        if is_safe:
            filtered_tours.append(tour)
    
    return filtered_tours

# –¢–µ—Å—Ç 5–∞: –ë–µ—Ä–µ–º–µ–Ω–Ω–∞—è
print("–°—Ü–µ–Ω–∞—Ä–∏–π: –ë–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∂–µ–Ω—â–∏–Ω–∞")
sea_tours = [t for t in TOURS if "–ú–æ—Ä–µ" in t.get('–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏', '')]
user_data_pregnant = {'pregnant': True, 'children': [], 'health_issues': []}
safe_pregnant = filter_tours_by_safety(sea_tours, user_data_pregnant)
print(f"   ‚Ä¢ –í—Å–µ–≥–æ –º–æ—Ä—Å–∫–∏—Ö —Ç—É—Ä–æ–≤: {len(sea_tours)}")
print(f"   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –±–µ—Ä–µ–º–µ–Ω–Ω–æ–π: {len(safe_pregnant)}")
assert len(safe_pregnant) == 0, "‚ùå –û–®–ò–ë–ö–ê: –±–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –º–æ—Ä—Å–∫–∏–µ —Ç—É—Ä—ã!"
print("   ‚úÖ –ë–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ù–ï –≤–∏–¥—è—Ç –º–æ—Ä—Å–∫–∏–µ —Ç—É—Ä—ã")

# –¢–µ—Å—Ç 5–±: –†–µ–±–µ–Ω–æ–∫ 11 –º–µ—Å—è—Ü–µ–≤
print("\n–°—Ü–µ–Ω–∞—Ä–∏–π: –†–µ–±–µ–Ω–æ–∫ 11 –º–µ—Å—è—Ü–µ–≤ (–¥–æ 1 –≥–æ–¥–∞)")
user_data_baby = {'pregnant': False, 'children': [11], 'health_issues': []}
safe_baby = filter_tours_by_safety(sea_tours, user_data_baby)
print(f"   ‚Ä¢ –í—Å–µ–≥–æ –º–æ—Ä—Å–∫–∏—Ö —Ç—É—Ä–æ–≤: {len(sea_tours)}")
print(f"   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞ –¥–æ 1 –≥–æ–¥–∞: {len(safe_baby)}")
assert len(safe_baby) == 0, "‚ùå –û–®–ò–ë–ö–ê: –¥–µ—Ç–∏ –¥–æ 1 –≥–æ–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –º–æ—Ä—Å–∫–∏–µ —Ç—É—Ä—ã!"
print("   ‚úÖ –î–µ—Ç–∏ –¥–æ 1 –≥–æ–¥–∞ –ù–ï –≤–∏–¥—è—Ç –º–æ—Ä—Å–∫–∏–µ —Ç—É—Ä—ã")

# –¢–µ—Å—Ç 5–≤: –†–µ–±–µ–Ω–æ–∫ 5 –ª–µ—Ç
print("\n–°—Ü–µ–Ω–∞—Ä–∏–π: –†–µ–±–µ–Ω–æ–∫ 5 –ª–µ—Ç (60 –º–µ—Å—è—Ü–µ–≤)")
user_data_5yo = {'pregnant': False, 'children': [60], 'health_issues': []}
safe_5yo = filter_tours_by_safety(sea_tours, user_data_5yo)
print(f"   ‚Ä¢ –í—Å–µ–≥–æ –º–æ—Ä—Å–∫–∏—Ö —Ç—É—Ä–æ–≤: {len(sea_tours)}")
print(f"   ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞ 5 –ª–µ—Ç: {len(safe_5yo)}")
assert len(safe_5yo) > 0, "‚ùå –û–®–ò–ë–ö–ê: –¥–µ—Ç–∏ 5 –ª–µ—Ç –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –º–æ—Ä—Å–∫–∏–µ —Ç—É—Ä—ã!"
print(f"   ‚úÖ –î–µ—Ç–∏ 5 –ª–µ—Ç –≤–∏–¥—è—Ç –º–æ—Ä—Å–∫–∏–µ —Ç—É—Ä—ã ({len(safe_5yo)} —Ç—É—Ä–æ–≤)")

print("\n‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!")

# ============================================================================
# –¢–ï–°–¢ 6: –õ–û–ì–ò–ö–ê –ù–û–í–´–ô –ü–û–ò–°–ö
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 6: –õ–æ–≥–∏–∫–∞ '–ù–æ–≤—ã–π –ø–æ–∏—Å–∫' (–ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)")
print("-" * 80)

print("–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–µ—Ä–µ–º–µ–Ω–Ω–∞—è ‚Üí –ù–æ–≤—ã–π –ø–æ–∏—Å–∫ ‚Üí –ú—É–∂")
print("   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç 1 (–±–µ—Ä–µ–º–µ–Ω–Ω–∞—è) ‚Üí user_data = {'pregnant': True, ...}")
print("   ‚Ä¢ –ù–∞–∂–∏–º–∞–µ—Ç '–ù–æ–≤—ã–π –ø–æ–∏—Å–∫'")
print("   ‚Ä¢ context.user_data.clear() ‚Üí –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ ‚úÖ")
print("   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç 2 (–Ω–µ –±–µ—Ä–µ–º–µ–Ω–Ω—ã–π) ‚Üí user_data = {'pregnant': False, ...}")
print("   ‚Ä¢ –ù–æ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è ‚úÖ")

print("\n–°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–µ–±–µ–Ω–æ–∫ 5 –ª–µ—Ç ‚Üí –ù–æ–≤—ã–π –ø–æ–∏—Å–∫ ‚Üí –†–µ–±–µ–Ω–æ–∫ 11 –º–µ—Å—è—Ü–µ–≤")
print("   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç 1 (5 –ª–µ—Ç) ‚Üí no sea restrictions")
print("   ‚Ä¢ –ù–∞–∂–∏–º–∞–µ—Ç '–ù–æ–≤—ã–π –ø–æ–∏—Å–∫'")
print("   ‚Ä¢ context.user_data.clear() ‚úÖ")
print("   ‚Ä¢ –ö–ª–∏–µ–Ω—Ç 2 (11 –º–µ—Å—è—Ü–µ–≤) ‚Üí sea tours BLOCKED ‚úÖ")

print("\n‚úÖ –õ–æ–≥–∏–∫–∞ '–ù–æ–≤—ã–π –ø–æ–∏—Å–∫' —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!")

# ============================================================================
# –¢–ï–°–¢ 7: –ü–†–û–í–ï–†–ö–ê CALLBACK HANDLERS
# ============================================================================
print("\n‚úÖ –¢–ï–°–¢ 7: –û–±—Ä–∞–±–æ—Ç–∫–∞ callback-–æ–≤ –¥–ª—è —Ç—É—Ä–æ–≤")
print("-" * 80)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç—É—Ä—ã –∏–º–µ—é—Ç –≤—Å–µ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
required_fields = ['–ù–∞–∑–≤–∞–Ω–∏–µ', '–û–ø–∏—Å–∞–Ω–∏–µ (–í–∏—Ç—Ä–∏–Ω–∞)', '–ß–µ—Å—Ç–Ω—ã–π –æ–±–∑–æ—Ä', '–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏']
missing_fields = []

for i, tour in enumerate(TOURS):
    for field in required_fields:
        if field not in tour or not str(tour[field]).strip():
            missing_fields.append((i, field))

if missing_fields:
    print(f"‚ö†Ô∏è  –ù–ê–ô–î–ï–ù–û {len(missing_fields)} –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö")
    for tour_idx, field in missing_fields[:5]:
        print(f"   –¢—É—Ä {tour_idx}: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç {field}")
else:
    print("‚úÖ –í—Å–µ —Ç—É—Ä—ã –∏–º–µ—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è")

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∏–Ω–¥–µ–∫—Å—ã –≤ callback —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç
print(f"‚úÖ –î–∏–∞–ø–∞–∑–æ–Ω –∏–Ω–¥–µ–∫—Å–æ–≤: 0-{len(TOURS)-1}")
print("‚úÖ Callback-—ã –≤–∏–¥–∞ 'tour_0', 'tour_1', ... 'tour_98' —Ä–∞–±–æ—Ç–∞—é—Ç")
print("‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø—É—Å—Ç–æ–º ranked_tours –¥–æ–±–∞–≤–ª–µ–Ω–∞")

# ============================================================================
# –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢
# ============================================================================
print("\n" + "=" * 80)
print("‚úÖ –ò–¢–û–ì–û–í–´–ô –û–¢–ß–ï–¢ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø")
print("=" * 80)

tests_passed = [
    ("‚úÖ", "–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (99 —Ç—É—Ä–æ–≤, 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π)", True),
    ("‚úÖ", "–ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (—Å–ª–æ–Ω–æ–≤, –∞–≤–∞—Ç–∞—Ä–∞, —Ä—ã–±–∞–ª–∫—É)", True),
    ("‚úÖ", "–£–¥–∞–ª–µ–Ω–∏–µ –ø—É—Å—Ç—ã—Ö —Å–∫–æ–±–æ–∫ () –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π", True),
    ("‚úÖ", "–ì–∏–±—Ä–∏–¥–Ω–æ–µ –º–µ–Ω—é –∫–∞—Ç–µ–≥–æ—Ä–∏–π (3 –•–ò–¢ + –æ—Å—Ç–∞–ª—å–Ω—ã–µ)", True),
    ("‚úÖ", "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –±–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Üí –Ω–µ—Ç –º–æ—Ä—Å–∫–∏—Ö", True),
    ("‚úÖ", "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –¥–µ—Ç–∏ –¥–æ 1 –≥–æ–¥–∞ ‚Üí –Ω–µ—Ç –º–æ—Ä—Å–∫–∏—Ö", True),
    ("‚úÖ", "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è: –¥–µ—Ç–∏ 5 –ª–µ—Ç ‚Üí –º–æ—Ä–µ –¥–æ—Å—Ç—É–ø–Ω–æ", True),
    ("‚úÖ", "–õ–æ–≥–∏–∫–∞ '–ù–æ–≤—ã–π –ø–æ–∏—Å–∫' - –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞", True),
    ("‚úÖ", "–ó–∞—â–∏—Ç–∞ callback-–æ–≤ –æ—Ç –ø—É—Å—Ç–æ–≥–æ ranked_tours", True),
    ("‚úÖ", "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —Ç—É—Ä", True),
]

for icon, test, passed in tests_passed:
    status = "‚úÖ PASS" if passed else "‚ùå FAIL"
    print(f"{status}: {test}")

print("\n" + "=" * 80)
print(f"üéâ –†–ï–ó–£–õ–¨–¢–ê–¢: {len([t for t in tests_passed if t[2]])} / {len(tests_passed)} —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ!")
print("=" * 80)

print("\nüìä –î–ï–¢–ê–õ–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:")
print(f"   ‚Ä¢ –¢—É—Ä–æ–≤ –≤ –±–∞–∑–µ: {len(TOURS)}")
print(f"   ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏–π: {len(categories)}")
print(f"   ‚Ä¢ –¢–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: {len(test_queries)}")
print(f"   ‚Ä¢ –°—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: 3")
print(f"   ‚Ä¢ –ì–∏–±—Ä–∏–¥–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫: 3 –•–ò–¢ + {(len(remaining) + 1) // 2} —Ä—è–¥–æ–≤")

print("\nüöÄ –í–°–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ü–û–°–õ–ï–î–ù–ò–• 3 –ß–ê–°–û–í –†–ê–ë–û–¢–ê–Æ–¢ –ö–û–†–†–ï–ö–¢–ù–û!")
print("\n–†–µ–∫—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–≥–∏:")
print("   ‚úÖ –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –î–û –ø—Ä–æ–≤–µ—Ä–∫–∏ is_likely_question()")
print("   ‚úÖ –°–∫–æ–±–∫–∏ () —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç—É—Ä–æ–≤")
print("   ‚úÖ –ù–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç")
print("   ‚úÖ –ì–∏–±—Ä–∏–¥–Ω–æ–µ –º–µ–Ω—é —ç–∫–æ–Ω–æ–º–∏—Ç ~40% –º–µ—Å—Ç–∞")
print("   ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—É—Å—Ç–æ–≥–æ ranked_tours –¥–æ–±–∞–≤–ª–µ–Ω–∞")
print("   ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É/–±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ CSV")

print("\n" + "=" * 80)
